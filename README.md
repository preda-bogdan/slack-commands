# ThemeIsle Slack /commands for visual regression testing

## Installation

1. Run `npm install`
2. Send Slack commands `POST` requests to `http://your.server.here/slack-commands/themeisle-wraith-commands.php`

## Prerequsites

1. Install Wraith and Deps 
```
apt-get install imagemagick
npm install casperjs [OR] npm install phantomjs [OR BOTH] 
gem install wraith [! Ruby required]
```

## Commands

1. `/history [theme-slug]` - generates a reference point for the theme slug hosted at `https://demo.themeisle.com/`
2. `/wraith [theme-slug]` - generates a snap of the theme slug hosted at `https://demo.themeisle.com/` and compares it
with the reference point generated by running `/history` command. **Generates a report**.
3. `/wraith_compare [http://first.domain vs http://second.domain]` compares the two provided domains visually. 
**Generates a report**.


## Travis Endpoints

You can make a `POST` request to `http://your.server.here/slack-commands/themeisle-wraith-service.php` with
the following `key => value` pairs:

1. `['mode'] => 'sitemaps'` - Generates config files for all slugs found in `https://demo.themeisle.com/wp-json/sites/all`
2. `['mode'] => 'crawl', ['slug'] => 'theme-slug'` - Generates config file for the given theme slug.

Commands are also accessible via shell:

1. `php /path/to/themeisle-wraith-service.php -m=sitemaps`
1. `php /path/to/themeisle-wraith-service.php -m=crawl -s=theme-slug`